<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="Content-Language" content="en-us" />
  <meta http-equiv="imagetoolbar" content="false" />
  <meta name="MSSmartTagsPreventParsing" content="true" />
  <meta name="description" content="Setup Cordova to create a hybrid native WebRTC app on iOS." />
  <meta name="viewport" content="initial-scale=1" />
  <title>Use Cordova with iOS and WebRTC | SIP.js</title>
  <link rel="alternate" type="application/atom+xml" title="API Changes" href="/changes.atom" />
  <link href='//fonts.googleapis.com/css?family=Nunito:400,700,300|Varela+Round' rel='stylesheet' type='text/css'>
  <link href="/css/reset.css" rel="stylesheet" type="text/css" />
  <link href="/css/960.css" rel="stylesheet" type="text/css" />
  <link href="/css/uv_active4d.css" rel="stylesheet" type="text/css" />
  <link href="/shared/css/documentation.css" media="screen" rel="stylesheet" type="text/css" />
    
  <link href="/shared/css/pygments.css" media="screen" rel="stylesheet" type="text/css" />
  
  <script src="/shared/js/jquery.js" type="text/javascript"></script>
  <script src="/shared/js/documentation.js" type="text/javascript"></script>
  <link rel="shortcut icon" type="image/x-icon" href="/shared/img/favicon-7.ico"/>
</head>


<body class="guides">
  <div id="dev"></div>
<header id="siteHeader">
  <div class="wrapper">
    <nav id="mainNav">
      <a id="logo-link" href="/"><img id="logo" src="/shared/img/logo.png" alt="sip.js"></a>
      <ul id="full-nav" class="horizontal mobile-hide">
        <li><a href="/download/">Download</a></li>
        <li><a id="api-nav" href="/api/0.12.0/">API</a></li>
        <li><a href="/guides/">Guides</a></li>
        <li><a href="https://github.com/onsip/sip.js" target="_blank">Github</a></li>
        <li><a href="/aboutus/" class="nav-aboutus">About Us</a></li>
        <li><a href="https://groups.google.com/forum/#!forum/sip_js" target="_blank">Support</a></li>
        <li><a href="/faq/">FAQ</a></li>
      </ul>
    </nav>
  </div>
</header>


  <article id="main" class="wrapper group">
    <header id="sectionHeader">
      <h1><a href="/guides/">Guides</a></h1>
    </header>
    <div id="content">
      
<section class="callout">
<h3>This guide is out of date.</h3>
<p>We are no longer supporting this mobile guide. It is still here strictly for informational purposes. We do not expect this guide to still work.</p>
</section>

<h1 id="using-cordova-with-ios-and-webrtc">Using Cordova with iOS and WebRTC</h1>

<h2 id="requirements">Requirements</h2>

<p>To create a hybrid native iOS WebRTC app you will need:</p>

<ul>
  <li><a href="http://www.apple.com/osx/">Mac OS X</a></li>
  <li><a href="https://developer.apple.com/programs/ios/">Apple iOS Developer Account</a></li>
  <li>
<a href="http://store.apple.com/us/iphone">Physical iOS device</a> (this will not work on an emulator)</li>
  <li>
<a href="http://cordova.apache.org/">Cordova</a> - If you are running <a href="http://nodejs.org/">Node.js</a>, you can run <code>npm install -g cordova</code>
</li>
  <li>(Optional) <a href="https://developer.apple.com/xcode/">XCode</a>
</li>
  <li>(Optional) <a href="https://github.com/phonegap/ios-deploy">ios-deploy</a> - If you are running <a href="http://nodejs.org/">Node.js</a>, you can run <code>npm install -g ios-deploy</code>
</li>
</ul>

<p>The Cordova plugin includes WebRTC libraries for iOS, SIP.js, a custom media handler to use the iOS WebRTC libraries, and a Cordova build script to build and run the project on devices.</p>

<h2 id="project-setup">Project Setup</h2>

<h3 id="install-cordova">Install Cordova</h3>

<p>Open terminal and navigate to the directory you want to create your project in. Run the following commands to create a Cordova iOS project. Replace <code>Cordova-SIPjs</code> with your own project name.</p>

<p><code>cordova create Cordova-SIPjs</code></p>

<p><code>cd Cordova-SIPjs</code></p>

<p><code>cordova platform add ios</code></p>

<h3 id="add-the-onsip-cordova-plugin">Add the OnSIP Cordova Plugin</h3>

<p>Run the following command to add the PhoneRTC WebRTC library to your Cordova project.</p>

<p><code>cordova plugin add https://github.com/onsip/onsip-cordova.git</code></p>

<h2 id="html-and-javascript">HTML and Javascript</h2>

<p>The HTML and Javascript required to use the plugin is very similar to regular SIP.js applications that would run in the browser. The only difference is that you need to set the app to use the plugin installed SIP.js and MediaHandler.</p>

<div class="language-javascript highlighter-coderay">
<table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
</pre></td>
  <td class="code"><pre><span class="comment">// Use plugin version of SIP.js</span>
<span class="keyword">var</span> SIP = cordova.require(<span class="string"><span class="delimiter">"</span><span class="content">com.onsip.cordova.Sipjs</span><span class="delimiter">"</span></span>);

<span class="comment">// Use plugin version of MediaHandler</span>
<span class="keyword">var</span> PhoneRTCMediaHandler = cordova.require(<span class="string"><span class="delimiter">"</span><span class="content">com.onsip.cordova.SipjsMediaHandler</span><span class="delimiter">"</span></span>)(SIP);

<span class="comment">// Set my UA to use the MediaHandler</span>
<span class="keyword">var</span> ua = <span class="keyword">new</span> SIP.UA({
  <span class="key">mediaHandlerFactory</span>: PhoneRTCMediaHandler
});
</pre></td>
</tr></table>
</div>

<h2 id="running-the-project">Running the project</h2>

<h3 id="running-project-from-command-line">Running project from Command Line</h3>

<ul>
  <li>Note: If you are running the project from XCode you can skip this section.</li>
</ul>

<p>Ensure your device is plugged into your computer and provisioned for development. Then run the following command.</p>

<p><code>cordova run ios</code></p>

<h3 id="running-project-from-xcode">Running project from XCode</h3>

<p>The architecture needs to be set to armv7. This is because the WebRTC libraries that are included are precompiled for this architecture. Trying to compile the libraries with other architectures will cause a linker error and your project will not compile.
Open the platforms folder then the ios folder. In the ios folder you will see an xcodeproj. Open the xcodeproj with XCode.
In XCode navigate to the build settings for <code>CordovaLib.xcodeproj</code>.</p>

<p>Set <code>Build Active Architecture Only</code> to <code>No</code></p>

<p>Set <code>Valid Architectures</code> to <code>armv7</code></p>

<p>Navigate to the build settings for <code>HelloCordova.xcodeproj</code>.</p>

<p>Set <code>Build Active Architecture Only</code> to <code>No</code></p>

<p>Set <code>Valid Architectures</code> to <code>armv7</code></p>

<ul>
  <li>You should now be able to compile and run the sample Cordova project on your iOS device. If you are still having linker errors verify the settings above and clean the project before building.</li>
</ul>

<h2 id="known-limitations">Known limitations</h2>

<p>These are currently the known limitations of the Cordova Plugin:</p>

<ul>
  <li>One call at a time (audio or audio/video).</li>
  <li>No HTML/Javascript video manipulation.</li>
</ul>

<h2 id="troubleshooting">Troubleshooting</h2>

<p>If you have difficulty, please reach out to us on our <a href="https://groups.google.com/forum/#!forum/sip_js">mailing list</a> or open an issue on the projectâ€™s <a href="https://github.com/onsip/onsip-cordova">GitHub page</a>.</p>

    </div>

    <nav id="sideNav">
  <ul>
    <li><a href="/guides/">Overview</a></li>
    <li class="parent">
      <a class="parent" href="/guides/server-configuration/">Server Configuration</a>
      <ul>
        <li><a href="/guides/server-configuration/freeswitch/">FreeSWITCH</a></li>
        <li><a href="/guides/server-configuration/asterisk/">Asterisk</a></li>
        <li><a href="/guides/server-configuration/onsip-network/">OnSIP</a></li>
      </ul>
    </li>
    <li><a href="/guides/convert-to-sipjs/">Convert to SIP.js</a></li>
    <li><a href="/guides/simple/">Simple</a></li>
    <li><a href="/guides/user-agent-construction/">User Agent Construction</a></li>
    <li><a href="/guides/make-call/">Make a Call</a></li>
    <li><a href="/guides/receive-call/">Receive a Call</a></li>
    <li><a href="/guides/attach-media">Attach Media</a></li>
    <li><a href="/guides/send-dtmf/">Send DTMF</a></li>
    <li><a href="/guides/send-message/">Send Message</a></li>
    <li><a href="/guides/transfer/">Make a Transfer</a></li>
    <li><a href="/guides/renegotiation">Renegotiation</a></li>
    <li><a class="last" href="/guides/full-demo-app/">Application Demo</a></li>
  </ul>
</nav>


  </article>

  <footer class="light-gray-bg">
  <div class="wrapper">
    <div id="onsip-stamp">
      <span id="made-by-prefix">made by</span>
      <a href="http://developer.onsip.com" id="onsip"></a>
    </div>
    <nav class="left">
      <ul class="horizontal">
        <li><a href="https://groups.google.com/forum/#!forum/sip_js" target="_blank">Mailing List</a></li>
        <li><a href="https://github.com/onsip/sip.js/issues" target="_blank">Report Issues</a></li>
        <li><a href="/license/">License</a></li>
      </ul>
    </nav>
    <nav class="right">
      <ul class="horizontal">
        <li><a href="https://travis-ci.org/onsip/SIP.js"><img src="https://travis-ci.org/onsip/SIP.js.png?branch=master"/></a></li>
        <li><a href="http://onsip.com/blog" target="_blank">Blog</a></li>
        <li><a href="/aboutus/">About</a></li>
        <li><a href="/faq/">FAQ</a></li>
      </ul>
    </nav>
    <div class="clearfix"></div>
  </div>
</footer>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-1008379-16', 'sipjs.com');
  ga('send', 'pageview');
</script>
<script>
  // Remove all 'no-js-hide' classes because Javascript is working
  $(function () {
      $('.no-js-hide').each(function (i, e) {
          $(e).removeClass('no-js-hide');
      });
      $('.no-js-block').each(function (i, e) {
          $(e).removeClass('no-js-block');
      });
  });
</script>


</body>
</html>
