<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="Content-Language" content="en-us" />
  <meta http-equiv="imagetoolbar" content="false" />
  <meta name="MSSmartTagsPreventParsing" content="true" />
  <meta name="description" content="How to use SIP.js Simple User to make and receive a call" />
  <meta name="viewport" content="initial-scale=1" />
  <title>Simple User | SIP.js</title>
  <link rel="alternate" type="application/atom+xml" title="API Changes" href="/changes.atom" />
  <link href='//fonts.googleapis.com/css?family=Nunito:400,700,300|Varela+Round' rel='stylesheet' type='text/css'>
  <link href="/css/reset.css" rel="stylesheet" type="text/css" />
  <link href="/css/960.css" rel="stylesheet" type="text/css" />
  <link href="/css/uv_active4d.css" rel="stylesheet" type="text/css" />
  <link href="/shared/css/documentation.css" media="screen" rel="stylesheet" type="text/css" />
    
  <link href="/shared/css/pygments.css" media="screen" rel="stylesheet" type="text/css" />
  
  <script src="/shared/js/jquery.js" type="text/javascript"></script>
  <script src="/shared/js/documentation.js" type="text/javascript"></script>
  <link rel="shortcut icon" type="image/x-icon" href="/shared/img/favicon-7.ico"/>
</head>


<body class="guides">
  <div id="dev"></div>
<header id="siteHeader">
  <div class="wrapper">
    <nav id="mainNav">
      <a id="logo-link" href="/"><img id="logo" src="/shared/img/logo.png" alt="sip.js"></a>
      <ul id="full-nav" class="horizontal mobile-hide">
        <li><a href="/download/">Download</a></li>
        <li><a id="api-nav" href="/api/0.15.0/">API</a></li>
        <li><a href="/guides/">Guides</a></li>
        <li><a href="https://github.com/onsip/sip.js" target="_blank">Github</a></li>
        <li><a href="/aboutus/" class="nav-aboutus">About Us</a></li>
        <li><a href="https://groups.google.com/forum/#!forum/sip_js" target="_blank">Support</a></li>
        <li><a href="/faq/">FAQ</a></li>
      </ul>
    </nav>
  </div>
</header>


  <article id="main" class="wrapper group">
    <header id="sectionHeader">
      <h1><a href="/guides/">Guides</a></h1>
    </header>
    <div id="content">
      
<h1 id="sipjs-simple-user-guide">SIP.js Simple User Guide</h1>

<h2 id="overview">Overview</h2>

<p>This guide will walk you through getting up and running with SIP.js Simple User. This is the quickest and easiest way to get up and running with SIP.js, but only has the most basic call features supported. If you want to do anything more complex with SIP.js you will need to use the full API.</p>

<p>This guide uses <a href="https://www.typescriptlang.org/">typescript</a>.</p>

<h2 id="limitations">Limitations</h2>

<p>The Simple User is intended to be a simple interface to get users up and running quickly. Therefore we have intentionally designed it with several limitations to keep the API simple. If you need functionality outside of these limits you should use the full SIP.js API.</p>

<ul>
  <li>Minimal media control</li>
  <li>One simultaneous call at a time</li>
  <li>No call transfers</li>
  <li>Simplified DTMF controls</li>
</ul>

<h2 id="html">HTML</h2>

<p>Create an HTML file.</p>

<p>A <code>&lt;video&gt;</code> element is need to display the video stream.  The <code>&lt;video&gt;</code> element adds a standard way for browsers to display video over the internet without additional plugins. This makes <code>&lt;video&gt;</code> elements perfect for WebRTC.</p>

<p>Within the <code>&lt;body&gt;</code> tags, there is a <code>remoteVideo</code> <code>&lt;video&gt;</code> element, to display the video of the person being called.  There is also a <code>localVideo</code> <code>&lt;video&gt;</code> element, to display the video stream that is being sent to the person being called.  The local video stream should always be muted to prevent feedback.</p>

<pre><code class="language-html"><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">"stylesheet"</span> <span class="na">href</span><span class="o">=</span><span class="s">"my-styles.css"</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">video</span> <span class="na">id</span><span class="o">=</span><span class="s">"remoteVideo"</span><span class="p">&gt;&lt;/</span><span class="nt">video</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">video</span> <span class="na">id</span><span class="o">=</span><span class="s">"localVideo"</span> <span class="na">muted</span><span class="o">=</span><span class="s">"muted"</span><span class="p">&gt;&lt;/</span><span class="nt">video</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span></code></pre>

<h2 id="typescript">Typescript</h2>

<p>This guide uses Typescript which you will need to transpile into Javascript.</p>

<h3 id="import-sipjs">Import SIP.js</h3>

<p>SIP.js is built as a standard module and can be imported into your application. You should only import the individual components that you need for your application. For these demo’s we will be using the <code>SimpleUser</code> and <code>SimpleUserOptions</code> components.</p>

<pre><code class="language-javascript"><span class="kr">import</span> <span class="p">{</span> <span class="nx">SimpleUser</span><span class="p">,</span> <span class="nx">SimpleUserOptions</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">"sip.js/lib/platform/web"</span><span class="p">;</span></code></pre>

<h3 id="creating-a-simple-user">Creating a Simple User</h3>

<p>In order to make calls and send messages, create a Simple User.  Calling <code>new SimpleUser(server, options)</code> constructor, with a websocket server and options will create a new Simple User. A Simple User can handle attaching meda elements for you.</p>

<pre><code class="language-javascript">  <span class="kr">const</span> <span class="nx">simpleUser</span><span class="o">:</span> <span class="nx">SimpleUser</span><span class="p">;</span>

  <span class="c1">// SIP over WebSocket Server URL</span>
  <span class="c1">// The URL of a SIP over WebSocket server which will complete the call.</span>
  <span class="c1">// FreeSwitch is an example of a server which supports SIP over WebSocket.</span>
  <span class="c1">// SIP over WebSocket is an internet standard the details of which are</span>
  <span class="c1">// outside the scope of this documentation, but there are many resources</span>
  <span class="c1">// available. See: https://tools.ietf.org/html/rfc7118 for the specification.</span>
  <span class="kr">const</span> <span class="nx">server</span> <span class="o">=</span> <span class="s2">"wss://sip.example.com"</span><span class="p">;</span>

  <span class="c1">// SIP Address of Record (AOR)</span>
  <span class="c1">// This is the user's SIP address. It's "Where people can reach you."</span>
  <span class="c1">// SIP is an internet standard the details of which are outside the</span>
  <span class="c1">// scope of this documentation, but there are many resources available.</span>
  <span class="c1">// See: https://tools.ietf.org/html/rfc3261 for the specification.</span>
  <span class="kr">const</span> <span class="nx">aor</span> <span class="o">=</span> <span class="s2">"sip:alice@example.com"</span><span class="p">;</span>

  <span class="c1">// Configuration Options</span>
  <span class="c1">// These are configuration options for the `SimpleUser` instance.</span>
  <span class="c1">// Here we are setting the HTML audio element we want to use to</span>
  <span class="c1">// play the audio received from the remote end of the call.</span>
  <span class="c1">// An audio element is needed to play the audio received from the</span>
  <span class="c1">// remote end of the call. Once the call is established, a `MediaStream`</span>
  <span class="c1">// is attached to the provided audio element's `src` attribute.</span>
  <span class="kr">const</span> <span class="nx">options</span><span class="o">:</span> <span class="nx">SimpleUserOptions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">aor</span><span class="p">,</span>
    <span class="nx">media</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">local</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">video</span><span class="o">:</span> <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'localVideo'</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">HTMLVideoElement</span><span class="p">)</span>
      <span class="p">}</span>
      <span class="nx">remote</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">video</span><span class="o">:</span> <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'remoteVideo'</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">HTMLVideoElement</span><span class="p">)</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="c1">// Construct a SimpleUser instance</span>
  <span class="nx">simpleUser</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SimpleUser</span><span class="p">(</span><span class="nx">server</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span></code></pre>

<h3 id="starting-the-simple-user">Starting the Simple User</h3>

<p>Once the Simple User is created. We then need to connect it to our server. See our Server Guide’s for information on setting up a SIP server. To connect our Simple User we need to call the <code>connect()</code> function. This function returns a promise that resolves when the Simple User is connected. Once we are connected we will then need to register.</p>

<pre><code class="language-javascript">  <span class="c1">// Connect to server</span>
  <span class="nx">await</span> <span class="nx">simpleUser</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>

  <span class="c1">// Register to receive inbound calls</span>
  <span class="nx">await</span> <span class="nx">simpleUser</span><span class="p">.</span><span class="nx">register</span><span class="p">();</span></code></pre>

<h3 id="starting-a-call">Starting a Call</h3>

<p>After the Simple User has connected to the SIP server, a new call can be made by calling the <code>.call(destination)</code> method.</p>

<pre><code class="language-javascript"><span class="nx">simple</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s1">'bob@example.com'</span><span class="p">);</span></code></pre>

<p>After the call method is invoked, the browser will ask for permission to access the camera and microphone.  Permission must be allowed to make the call.  The person being called has the choice of accepting or rejecting the call.</p>

<p>An <code>hangup</code> button is added to terminate the session using the <code>.hangup()</code> method.</p>

<h3 id="answering-a-call">Answering a Call</h3>

<p>To know if you are getting call you need to register a Simple User Delegate that has callback methods for the Simple User to call when an event happens. The delegate is passed in the <code>SimpleUserOptions</code> To know when a call is received you need an <code>onCallReceived()</code> function.</p>

<pre><code class="language-javascript">  <span class="kr">const</span> <span class="nx">simpleUser</span><span class="o">:</span> <span class="nx">SimpleUser</span><span class="p">;</span>

  <span class="kr">const</span> <span class="nx">delegate</span><span class="o">:</span> <span class="nx">SimpleUserDelegate</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">onCallReceived</span><span class="o">:</span> <span class="nx">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Incoming Call!'</span><span class="p">);</span>
      <span class="nx">await</span> <span class="nx">simpleUser</span><span class="p">.</span><span class="nx">answer</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="kr">const</span> <span class="nx">options</span><span class="o">:</span> <span class="nx">SimpleUserOptions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">aor</span><span class="p">,</span>
    <span class="nx">delegate</span><span class="o">:</span> <span class="nx">delegate</span><span class="p">,</span>
    <span class="nx">media</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">local</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">video</span><span class="o">:</span> <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'localVideo'</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">HTMLVideoElement</span><span class="p">)</span>
      <span class="p">}</span>
      <span class="nx">remote</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">video</span><span class="o">:</span> <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'remoteVideo'</span><span class="p">)</span> <span class="nx">as</span> <span class="nx">HTMLVideoElement</span><span class="p">)</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="nx">simpleUser</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SimpleUser</span><span class="p">(</span><span class="nx">server</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>

  <span class="c1">// Connect to server</span>
  <span class="nx">await</span> <span class="nx">simpleUser</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>

  <span class="c1">// Register to receive inbound calls</span>
  <span class="nx">await</span> <span class="nx">simpleUser</span><span class="p">.</span><span class="nx">register</span><span class="p">();</span></code></pre>

<h3 id="placing-a-call-on-hold">Placing a Call on Hold</h3>

<p>To place a call on hold you can call the <code>hold()</code> function. Similarly to take a call off hold you can call <code>unhold()</code>.</p>

<pre><code class="language-javascript"><span class="nx">simpleUser</span><span class="p">.</span><span class="nx">hold</span><span class="p">();</span>

<span class="nx">simpleUser</span><span class="p">.</span><span class="nx">unhold</span><span class="p">();</span></code></pre>

<p>To detect if you have been placed on hold, you can add the `to your dele</p>

<h3 id="sending-dtmf">Sending DTMF</h3>

<p>To send DTMF tones you can call the <code>sendDTMF(tone: string)</code> function. This is a helper function that sends DTMF via INFO packets.</p>

<pre><code class="language-javascript"><span class="nx">simpleUser</span><span class="p">.</span><span class="nx">sendDTMF</span><span class="p">(</span><span class="s1">'1'</span><span class="p">);</span></code></pre>

<h3 id="ending-a-call">Ending a Call</h3>

<p>To end a call <code>hangup();</code>.</p>

<pre><code class="language-javascript"><span class="nx">simpleUser</span><span class="p">.</span><span class="nx">hangup</span><span class="p">();</span></code></pre>

    </div>

    <nav id="sideNav">
  <ul>
    <li><a href="/guides/">Overview</a></li>
    <li class="parent">
      <a class="parent" href="/guides/server-configuration/">Server Configuration</a>
      <ul>
        <li><a href="/guides/server-configuration/freeswitch/">FreeSWITCH</a></li>
        <li><a href="/guides/server-configuration/asterisk/">Asterisk</a></li>
        <li><a href="/guides/server-configuration/onsip-network/">OnSIP</a></li>
      </ul>
    </li>
    <li><a href="/guides/simple-user/">Simple User</a></li>
    <li><a href="/guides/user-agent/">User Agent</a></li>
    <li><a href="/guides/make-call/">Make a Call</a></li>
    <li><a href="/guides/receive-call/">Receive a Call</a></li>
    <li><a href="/guides/end-call/">End a Call</a></li>
    <li><a href="/guides/attach-media/">Attach Media</a></li>
    <li><a href="/guides/send-dtmf/">Send DTMF</a></li>
    <li><a href="/guides/send-message/">Send Message</a></li>
    <li><a href="/guides/transfer/">Make a Transfer</a></li>
    <li><a class="last" href="/guides/full-demo-app/">Application Demo</a></li>
  </ul>
</nav>


  </article>

  <footer class="light-gray-bg">
  <div class="wrapper">
    <div id="onsip-stamp">
      <span id="made-by-prefix">made by</span>
      <a href="http://developer.onsip.com" id="onsip"></a>
    </div>
    <nav class="left">
      <ul class="horizontal">
        <li><a href="https://groups.google.com/forum/#!forum/sip_js" target="_blank">Mailing List</a></li>
        <li><a href="https://github.com/onsip/sip.js/issues" target="_blank">Report Issues</a></li>
        <li><a href="/license/">License</a></li>
      </ul>
    </nav>
    <nav class="right">
      <ul class="horizontal">
        <li><a href="https://travis-ci.org/onsip/SIP.js"><img src="https://travis-ci.org/onsip/SIP.js.png?branch=master"/></a></li>
        <li><a href="http://onsip.com/blog" target="_blank">Blog</a></li>
        <li><a href="/aboutus/">About</a></li>
        <li><a href="/faq/">FAQ</a></li>
      </ul>
    </nav>
    <div class="clearfix"></div>
  </div>
</footer>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-1008379-16', 'sipjs.com');
  ga('send', 'pageview');
</script>
<script>
  // Remove all 'no-js-hide' classes because Javascript is working
  $(function () {
      $('.no-js-hide').each(function (i, e) {
          $(e).removeClass('no-js-hide');
      });
      $('.no-js-block').each(function (i, e) {
          $(e).removeClass('no-js-block');
      });
  });
</script>


</body>
</html>
